{% extends "base.dhtml" %}
{% load static %}

{% block title %}
  Voter Bowl x {{ school.short_name }}
{% endblock title %}

{% block body %}
  <style>
    me {
      background-color: black;
    }
  </style>
  <div data-bg-color="{{ school.logo.bg_color }}"
       data-color="{{ school.logo.bg_text_color }}">
    <style>
      me {
        --main-color: transparent;
        --main-bg-color: transparent;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      me a {
        color: var(--main-color);
        text-decoration: underline;
        transition: opacity 0.2s;
      }

      me a:hover {
        opacity: 0.7;
        transition: opacity 0.2s;
      }

      me main {
        width: 100%;
        text-align: center;
        padding: 2rem 0;
      }

      me main img {
        height: 150px;
        margin: 1.5rem 0;
      }

      me main p {
        font-weight: 378;
        font-size: 20px;
        line-height: 130%;
      }

      me main h2 {
        font-weight: 500;
        font-size: 36px;
        line-height: 120%;
        text-transform: uppercase;
      }

      me .faq {
        width: 100%;
        color: white;
        background-color: black;
        padding: 2rem 0;
      }

      me .button-holder {
        display: flex;
        justify-content: center;
        margin: 1.5rem 0;
      }
    </style>
    <script>
        (function(self) {
            onloadAdd(() => {
                self.style.setProperty('--main-color', self.dataset.color);
                self.style.setProperty('--main-bg-color', self.dataset.bgColor);
            });
        })(me());
    </script>
    <main>
      <style>
        me {
          color: var(--main-color);
          background-color: var(--main-bg-color);
        }

        me h2 {
          display: flex;
          justify-content: center;
          align-items: center;
        }

        me .hidden {
          display: none;
        }

        me .code {
          font-size: 0.75em;
        }

        me .clipboard,
        me .copied {
          margin-left: 0.2em;
          margin-top: 0.05em;
          width: 0.75em;
        }

        me .clipboard {
          opacity: 0.5;
          cursor: pointer;
          transition: opacity 0.2s;
        }

        me .clipboard:hover {
          opacity: 1;
          transition: opacity 0.2s;
        }

        me .copied {
          opacity: 0.5;
        }

        @media screen and (min-width: 768px) {

          me .clipboard,
          me .copied {
            margin-left: 0.2em;
            margin-top: 0.2em;
            width: 1em;
          }


          me .code {
            font-size: 1em;
          }
        }
      </style>
      <script>
          (function(self) {
              onloadAdd(() => {
                  const clipboard = self.querySelector(".clipboard");
                  const copied = self.querySelector(".copied");
                  const code = self.querySelector(".code");
                  if (!clipboard || !copied || !code) {
                      return;
                  }
                  clipboard.addEventListener("click", () => {
                      navigator.clipboard.writeText(code.innerText);
                      // hide the `clipboard` span; show the `copied` span
                      // do this by adding `hidden` class to `clipboard` and
                      // removing it from `copied`
                      clipboard.classList.add("hidden");
                      copied.classList.remove("hidden");
                  });
              });
          })(me());
      </script>
      <div class="container">
        <img src="{{ school.logo.url }}"
             alt="{{ school.short_name }} {{ school.mascot }} logo" />
        {% if contest_entry and claim_code %}
          <p>Congrats! You won a ${{ contest_entry.amount }} gift card!</p>
          <h2>
            <span class="code">{{ claim_code }}</span>
            <span class="clipboard" title="Copy to clipboard">{% include "clipboard.svg" %}</span>
            <span class="copied hidden" title="Copied!">{% include "clipboard_check.svg" %}</span>
          </h2>
          <p>
            To use your gift card, copy the code above and paste it into <a href="https://www.amazon.com/gc/redeem" target="_blank">Amazon.com</a>.
          </p>
          <p>
            Tell three friends right now so they can also win a gift card! Here's the link: <a href="{% url 'vb:school' slug=school.slug %}">{{ BASE_URL }}{% url 'vb:school' slug=school.slug %}</a>
          </p>
        {% elif contest_entry %}
          <p>Thanks for entering the Voter Bowl!</p>
          <p>Alas, you didn't win a gift card this time.</p>
          <p>
            Your friends still have a chance to win, though! Please share the contest link with them: <a href="{% url 'vb:school' slug=school.slug %}">{{ BASE_URL }}{% url 'vb:school' slug=school.slug %}</a>
          </p>
        {% elif error %}
          <p>
            Sorry, <b>there was an error</b>. Please try again later.
          </p>
          <p>
            If you continue to have issues, please contact us at <a href="mailto:info@voterbowl.org">info@voterbowl.org</a>.
          </p>
        {% else %}
          <p>Thanks for making sure you're ready to vote.</p>
          <p>Happy voting in 2024!</p>
        {% endif %}
      </div>
    </main>
    <div class="faq">
      <div class="container">{% include "includes/faq.dhtml" %}</div>
    </div>
    {% include "includes/footer.dhtml" %}
  </div>
{% endblock body %}
